@{
    Layout = "~/Views/_ana.cshtml";
}
@using UniStaj
@using UniStaj.veri;
@model UniStaj.Models.TopluSmsGonderimModel

<form id="formKayit" name="formKayit" autocomplete="off">
    @{
        int dilKimlik = Model.gecerliDil();
        bool eklemeIzniVarmi = (bool)ViewBag.eklemeIznivar;
        bool silmeIzniVarmi = (bool)ViewBag.silmeIznivar;
        <i style="float: left; width: 50%; color: white; ">
            @if (eklemeIzniVarmi)
            {
                <button type="button" class="btn btn-success btn-rounded waves-effect waves-light " onclick="kartAc(0);return false;">
                    <i class="mdi mdi-plus me-1"></i>
                    @Ikazlar.yeniKayitEkle("Toplu SMS Gönderim", dilKimlik)
                </button>
            }
            else
            {
                string y = "ekleme izniniz yok";
                @y
            }
        </i>
        <i style="float: right; width: 50%; text-align: right; color: white; ">
            @if (silmeIzniVarmi)
            {
                <button type="button" class="btn btn-danger btn-rounded waves-effect waves-light" onclick="sil(); return fals;">
                    <i class="mdi mdi-minus me-1"></i>
                    @Ayar.sozcuk("Seçilen Kayıtları Sil", dilKimlik)
                </button>
            }
            else
            {
                string y = "silme izniniz yok";
                @y
            }
        </i>
        <div style="float: left; width: 100%; height:30px;  "></div>
        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
            <thead>
                <tr>
                    <th> </th>
                    <th> @Ayar.sozcuk("Tarih", dilKimlik)</th>
                    <th> @Ayar.sozcuk("Açıklama", dilKimlik)</th>
                    <th>
                        @Ayar.sozcuk("Güncelle", dilKimlik)
                    </th>
                </tr>
            </thead>
            <tbody>
                @{
                    List<TopluSmsGonderimAYRINTI> veri = Model.dokumVerisi;
                    foreach (var satir in veri)
                    {
                        <tr row_id="@satir._birincilAnahtar().ToString()">
                            <td>
                                <input type="checkbox" class="checkBox"
                                       value="@satir._birincilAnahtar()" />
                            </td>
                            <td>@satir.tarih</td>
                            <td>@satir.aciklama</td>
                            <td>
                                <a class="@UniStaj.Ayar.btnGridGuncelle" onclick="kartAc(@satir._birincilAnahtar()); return false;" style="color: #ffffff !important; background-color: #ffae00; border-color: #ffae00; " title="Edit">
                                    <i class="fas fa-pencil-alt"></i>
                                </a>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    }
</form>
<script>
            function kartAc(id) {
                window.location.href = "/TopluSmsGonderim/Kart/"+id;
            }
            function sil() {
                var selectedIDs = new Array();
                $('input:checkbox.checkBox').each(function () {
                    if ($(this).prop('checked')) {
                        selectedIDs.push($(this).val());
                    }
                });
                if (selectedIDs.length == 0) {
                    alert('@Ayar.sozcuk("Lütfen silmek istediğiniz kayıtları seçiniz", dilKimlik)')
                    return;
                }
                var options = {};
                options.url = "/TopluSmsGonderim/Sil?id=" + selectedIDs;
                options.type = "POST";
                options.data = JSON.stringify(selectedIDs);
                options.contentType = "application/json";
                options.dataType = "json";
                options.success = function (msg) {
                    Swal.fire({
                        position: "center-center", icon: "success",
                         title:  '@Ikazlar.basariylaSilindi(dilKimlik)', showConfirmButton: !1, timer: 1750,
                    });
                    setTimeout(function () {
                        window.location.reload(1);
                    }, 1750);  //
                };
                options.error = function () {
                    Swal.fire(
                        'Hata',
                        msg,
                        'error'
                    );
                };
                $.ajax(options);
                return false;
            }
</script>

