@{ 
    Layout = "~/Views/_ana.cshtml";
}
@using UniStaj 
@using UniStaj.veri;
@model UniStaj.Models.StajBasvurusuModel
    <script src="~/assets/js/jquery.dataTables.min.js"></script>
    <form id="formKayit" name="formKayit" autocomplete="off">
        @{
        int dilKimlik = Model.gecerliDil();
               <div class="card-body border-bottom" style="background-color: @Ayar.aramaKutusuArkaPlan;">
            <div class="row g-3"><div class="@Ayar.aramaSutunGenislik">@Html.DropDownListFor(m => m.aramaParametresi.i_stajyerKimlik, Bilesen.doldur(Model._ayStajyerAYRINTI) ,  @Ayar.sozcuk("Stajyer", dilKimlik), new { @class = "form-control select2" })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.stajKurumAdi, new { @class = @Ayar.textBoxBicim(), maxlength = "200" ,   placeholder = @Ayar.sozcuk("Kurum", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.DropDownListFor(m => m.aramaParametresi.i_stajTuruKimlik, Bilesen.doldur(Model._ayStajTuruAYRINTI) ,  @Ayar.sozcuk("Staj Türü", dilKimlik), new { @class = "form-control select2" })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.hizmetAlani, new { @class = @Ayar.textBoxBicim(), maxlength = "50" ,   placeholder = @Ayar.sozcuk("Hizmet Alanı", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.vergiNo, new { @class = @Ayar.textBoxBicim(), maxlength = "50" ,   placeholder = @Ayar.sozcuk("Vergi No", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.telNo, new { @class = @Ayar.textBoxBicim(), maxlength = "12" ,   placeholder = @Ayar.sozcuk("Tel No", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.ePosta, new { @class = @Ayar.textBoxBicim(), maxlength = "150" ,   placeholder = @Ayar.sozcuk("E-Posta", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.yetkilisi, new { @class = @Ayar.textBoxBicim(), maxlength = "200" ,   placeholder = @Ayar.sozcuk("Yetkili", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.gunSayisi, new { @class = @Ayar.textBoxBicim(),   placeholder = @Ayar.sozcuk("Gün Sayısı", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.TextBoxFor(m => m.aramaParametresi.sinifi, new { @class = @Ayar.textBoxBicim(),   placeholder = @Ayar.sozcuk("Sınıfı", dilKimlik) })</div>
            <div class="@Ayar.aramaSutunGenislik">@Html.DropDownListFor(m => m.aramaParametresi.i_stajBasvuruDurumuKimlik, Bilesen.doldur(Model._ayref_StajBasvuruDurumu) ,  @Ayar.sozcuk(".", dilKimlik), new { @class = "form-control select2" })</div>
             <div class="col-xxl-2 col-lg-4">
                    <button type="button" class="btn btn-soft-secondary w-100" style="background-color:#e5f4ff;" onclick="cek(); return false;"><i class="mdi mdi-filter-outline align-middle"></i>@Ayar.sozcuk("Ayrıntılı Ara", dilKimlik)  </button>
 </div>     </div>
        </div> <hr/>  <br/>

            bool eklemeIzniVarmi = (bool)ViewBag.eklemeIznivar;
            bool silmeIzniVarmi = (bool)ViewBag.silmeIznivar;
            <i style="float: left; width: 50%; color: white; ">
                @if (eklemeIzniVarmi)
                {
                    <button type="button" class="btn btn-success btn-rounded waves-effect waves-light " onclick="kartAc(0);return false;">
                        <i class="mdi mdi-plus me-1"></i>
                        @Ikazlar.yeniKayitEkle("Staj Başvurusu", dilKimlik) 
                    </button>
                }
                else
                {
                    string y = "ekleme izniniz yok";
                    @y
                }
            </i>
            <i style="float: right; width: 50%; text-align: right; color: white; ">
                @if (silmeIzniVarmi)
                {
                    <button type="button" class="btn btn-danger btn-rounded waves-effect waves-light" onclick="sil(); return fals;">
                        <i class="mdi mdi-minus me-1"></i>
                       @Ayar.sozcuk("Seçilen Kayıtları Sil", dilKimlik)
                    </button>
                }
                else
                {
                    string y = "silme izniniz yok";
                    @y
                }
            </i>
            <div style="float: left; width: 100%; height:30px;  "></div>
            <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                <thead>
                    <tr>
                        <th> </th>
    <th> @Ayar.sozcuk( "Stajyer", dilKimlik)</th>
    <th> @Ayar.sozcuk("Sınıfı", dilKimlik)</th>
    <th> @Ayar.sozcuk("Staj Türü", dilKimlik)</th>
    <th> @Ayar.sozcuk("Başlangıç", dilKimlik)</th>
    <th> @Ayar.sozcuk("Bitiş", dilKimlik)</th>
    <th> @Ayar.sozcuk("Gün Sayısı", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Kurum Adı", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Kurum Türü", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Hizmet Alanı", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Vergi No", dilKimlik)</th>
    <th> @Ayar.sozcuk( "IBAN", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Çalışan Sayısı", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Adresi", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Tel No", dilKimlik)</th>
    <th> @Ayar.sozcuk( "E-Posta", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Faks", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Web Sitesi", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Yetkili Ad Soyad", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Yetkili Görevi", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Yetkili Tel", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Çalışma Günleri", dilKimlik)</th>
    <th> @Ayar.sozcuk( "Kodu", dilKimlik)</th>
                        <th>
                             @Ayar.sozcuk("Güncelle", dilKimlik)
                        </th>
                    </tr>
                </thead>
                <tbody>
  @{    List<StajBasvurusuAYRINTI> veri = Model.dokumVerisi;
                        foreach (var satir in veri)
                        {
                            <tr row_id="@satir._birincilAnahtar().ToString()">
                                <td>
                                    <input type="checkbox" class="checkBox"
                                           value="@satir._birincilAnahtar()" />
                                </td>
<td>@satir.stajyerAdi @satir.stajyerSoyadi</td>
<td>@satir.sinifi</td>
<td>@satir.stajTuruAdi</td>
<td>@(satir.baslangic.HasValue ? satir.baslangic.Value.ToString("dd.MM.yyyy"): "")</td>
<td>@(satir.bitis.HasValue? satir.bitis.Value.ToString("dd.MM.yyyy"): "")</td>
<td>@satir.gunSayisi</td>
<td>@satir.stajKurumAdi</td>
<td>@(Model._ayStajKurumTuruAYRINTI.FirstOrDefault(x => x.stajKurumTurukimlik == satir.i_stajkurumturukimlik) ?.stajKurumTurAdi?? "-")</td>
<td>@satir.hizmetAlani</td>
<td>@satir.vergiNo</td>
<td>@satir.ibanNo</td>
<td>@satir.calisanSayisi</td>
<td>@satir.adresi</td>
<td>@satir.telNo</td>
<td>@satir.ePosta</td>
<td>@satir.faks</td>
<td>@satir.webAdresi</td>
<td>@satir.yetkilisi</td>
<td>@satir.yetkiliGorevi</td>
<td>@satir.yetkiliTel</td>
<td>@satir.calismaGunleri</td>
<td>@satir.kodu</td>
                                <td>
                                    <a class="btn btn-outline-secondary btn-sm edit" onclick="kartAc(@satir._birincilAnahtar()); return false;" style="color: #ffffff !important; background-color: #ffae00; border-color: #ffae00; " title="Edit">
                                        <i class="fas fa-pencil-alt"></i>
                                    </a>
                                </td>
                            </tr>
                        } }
                </tbody>
            </table> }
    </form>
    <script>
        function kartAc(id) {
window.location.href = "/StajBasvurusu/Kart/"+id;
        }
        function sil() {
            var selectedIDs = new Array();
            $('input:checkbox.checkBox').each(function () {
                if ($(this).prop('checked')) {
                    selectedIDs.push($(this).val());
                }
            });
            if (selectedIDs.length == 0) {
                alert('@Ayar.sozcuk("Lütfen silmek istediğiniz kayıtları seçiniz",dilKimlik)')
                return;
            }
            var options = {};
options.url = "/StajBasvurusu/Sil?id=" + selectedIDs;
            options.type = "POST";
            options.data = JSON.stringify(selectedIDs);
            options.contentType = "application/json";
            options.dataType = "json";
            options.success = function (msg) {  
                Swal.fire({
                    position: "center-center", icon: "success",
                     title:  '@Ikazlar.basariylaSilindi(dilKimlik)', showConfirmButton: !1, timer: 1750,
                });
                setTimeout(function () {
                    window.location.reload(1);
                }, 1750);  //
            };
            options.error = function () {
                Swal.fire(
                    'Hata',
                    msg,
                    'error'
                ); 
            };
            $.ajax(options);         
            return false;
        }
    function cek() {
        var valdata = $("#formKayit").serialize();
        console.table(valdata);
        $.ajax({
 url: "/StajBasvurusu/Cek/", 
            type: "Post",
            data: valdata,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            dataType: "json",
            success: function (response) {
                if (!response.success) {
                    Swal.fire(
                        '@Ayar.sozcuk("Hata", dilKimlik)',
                        response.message,
                        'error'
                    );
                    return false;
                }
                else {
                    window.location.href = response.message;
                }
            }
        });
    }
    </script>

