@{
    Layout = "~/Views/_ana.cshtml";
}
@using UniStaj.veri;
@model UniStaj.Models.HataBildirimlerimModel

<form id="formKayit" name="formKayit" autocomplete="off">
    @{

        <div style="float: left; width: 100%; height:30px;  "></div>
        <table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
            <thead>
                <tr>
                    <th> Kapandı Olarak İşaretle</th> 
                    <th>Durumu</th>
                    <th>Bildiren</th>
                    <th>Başlık</th>
                    <th>Tarih</th>
                    <td>
                        Oku / Yanıtla
                    </td>
                </tr>
            </thead>
            <tbody>
                @{
                    List<HataBildirimiAYRINTI> veri = Model.dokumVerisi;
                    foreach (var satir in veri)
                    {
                        <tr row_id="@satir._birincilAnahtar().ToString()">
                            <td>
                                <a class="@UniStaj.Ayar.btnGridGuncelle" onclick="hataKapat('@satir.kodu'); return false;" style="color: #ffffff !important; background-color: #009bff; border-color: #ffae00; " title="Edit">
                                    <i class="fas fa-pencil-alt"></i>
                                </a>
                            </td>

                            <td>@satir.hataBildirimDurumu</td>
                            <td>@satir.gercekAdi @satir.tcKimlikNo </td>
                            <td>@satir.baslik</td>
                            <td>@satir.tarih</td>



                            <td>
                                <a class="@UniStaj.Ayar.btnGridGuncelle" onclick="kartAc('@satir.kodu'); return false;" style="color: #ffffff !important; background-color: #ffae00; border-color: #ffae00; " title="Edit">
                                    <i class="fas fa-pencil-alt"></i>
                                </a>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    }
</form>
<script>
    function kartAc(id) {
        window.location.href = "/HataBildirimlerim/Yazisma/?id=" + id;
    }





    // cancan
    function hataKapat(id) {
        tinyMCE.triggerSave();
        var valdata = $("#formKayit").serialize();
        console.table(valdata);
        $.ajax({
            url: "/HataBildirimlerim/ArizaKapat/?id=" + id,
            type: "Post",
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            dataType: "json",
            success: function (response) {
                if (!response.success) {
                    Swal.fire(
                        'Hata',
                        response.message,
                        'error'
                    );
                    return false;
                }
                else {
                    Swal.fire(
                        'Başarılı',
                        response.message,
                        'success'
                    ).then(function () {
                        window.location.reload();
                    })
                }
            }
        });
    }

</script>

